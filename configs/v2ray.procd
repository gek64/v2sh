#!/bin/sh /etc/rc.common

USE_PROCD=1

boot() {
  ubus -t 30 wait_for network.interface network.wireless 2>/dev/null
  rc_procd start_service
}

start_service() {
  procd_open_instance
  procd_set_param env V2RAY_LOCATION_ASSET=/usr/local/etc/v2ray
  procd_set_param command /usr/local/bin/v2ray run -config /usr/local/etc/v2ray/config.json
  procd_set_param pidfile /var/run/v2ray.pid
  procd_set_param stdout 1
  procd_set_param stderr 1
  procd_close_instance
}